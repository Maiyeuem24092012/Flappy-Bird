<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Flappy Bird - C++ Logic</title>
    <style>
        body { margin: 0; background: #222; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }
        canvas { border: 4px solid #fff; background-color: #70c5ce; cursor: pointer; }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="288" height="512"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// --- ĐƯỜNG DẪN TÀI NGUYÊN (Dựa trên GitHub của bạn) ---
const IMG_BASE = "assets/images/";
const SND_BASE = "assets/audio/";

const res = {
    bg: new Image(), bird: new Image(), base: new Image(), pipe: new Image(),
    s_wing: new Audio(SND_BASE + "wing.ogg"),
    s_hit: new Audio(SND_BASE + "hit.ogg"),
    s_point: new Audio(SND_BASE + "point.ogg")
};

// Gán nguồn ảnh
res.bg.src = IMG_BASE + "background-day.png";
res.bird.src = IMG_BASE + "yellowbird-midflap.png";
res.base.src = IMG_BASE + "base.png";
res.pipe.src = IMG_BASE + "pipe-green.png";

// Biến mô phỏng từ main.cpp
let birdY = 250, velocity = 0, score = 0, alive = true;

function update() {
    if (alive) {
        velocity += 0.25; // Logic từ main.cpp
        birdY += velocity;
    }
    // Va chạm đất
    if (birdY > 400) {
        if (alive) res.s_hit.play();
        birdY = 400;
        alive = false;
    }
}

function render() {
    ctx.drawImage(res.bg, 0, 0);
    ctx.drawImage(res.bird, 50, birdY, 34, 24);
    ctx.drawImage(res.base, 0, 400, 288, 112);
    
    // Hiển thị điểm
    ctx.fillStyle = "white";
    ctx.font = "35px Arial";
    ctx.fillText(score, 135, 50);

    update();
    requestAnimationFrame(render);
}

// Xử lý click để nhảy
window.addEventListener("mousedown", () => {
    if (alive) {
        velocity = -5; // Jump Force từ main.cpp
        res.s_wing.play().catch(()=>{}); // Tránh lỗi trình duyệt chặn âm thanh
    } else {
        location.reload(); // Reset game
    }
});

render();
</script>
</body>
</html>
